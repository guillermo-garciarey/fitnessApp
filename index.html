<!doctype html>

<html>
  <head>
    <title>Fitness App</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />

    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#222222" />
  </head>
  <body class="is-preload">
    <!-- Header -->
    <header id="header">
      <img class="main_logo" src="images/EZFF_Stacked_Green.png" alt="" />
    </header>

    <!-- Login Form -->
    <form id="signup-form" method="post" action="#">
      <input
        class="email"
        type="email"
        name="email"
        id="email"
        placeholder="Email Address"
      />
      <input
        type="password"
        name="password"
        id="password"
        placeholder="Password"
      />
      <input type="submit" id="login-btn" value="Log In" />
      <input
        class="transparent"
        type="button"
        id="signup-btn"
        value="Sign Up"
      />
    </form>

    <!-- Signup Overlay -->
    <div id="signup-overlay" style="display: none">
      <h2>Sign Up Form</h2>
      <form id="create-account-form">
        <input type="text" id="signup-name" placeholder="First Name" required />
        <input type="text" id="signup-surname" placeholder="Surname" required />
        <input
          type="email"
          id="signup-email"
          placeholder="Email Address"
          required
        />
        <input
          type="password"
          id="signup-password"
          placeholder="Password"
          required
        />
        <input
          type="password"
          id="signup-password-confirm"
          placeholder="Confirm Password"
          required
        />
        <input type="text" id="signup-phone" placeholder="Phone Number" />
        <input type="submit" value="Create Account" />
      </form>
      <a href="">Cancel</a>
    </div>

    <!-- Footer -->
    <!-- <footer id="footer">
      <ul class="icons">
        <li>
          <a
            href="https://www.instagram.com/ezrazanefitness/"
            target="_blank"
            class="icon brands fa-instagram"
          >
            <span class="label">Instagram</span>
          </a>
        </li>
      </ul>
    </footer> -->

    <!-- Scripts -->
    <script src="assets/js/main.js"></script>
    <script type="module" src="assets/js/index.js"></script>
    <script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'

  // ðŸ”§ Replace with your project values
  const SUPABASE_URL = 'https://YOUR-PROJECT-REF.supabase.co'
  const SUPABASE_ANON_KEY = 'YOUR-PUBLIC-ANON-KEY'

  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

  // If the recovery link uses a 'code' param, exchange it for a session
  const url = new URL(window.location.href)
  const hasCode = url.searchParams.get('code')
  if (hasCode) {
    // safe to call even if session already exists
    supabase.auth.exchangeCodeForSession(window.location.href).catch(() => {})
  }

  // Listen for the recovery event and ask for a new password
  supabase.auth.onAuthStateChange(async (event) => {
    if (event === 'PASSWORD_RECOVERY') {
      const pw = prompt('Enter a new password')
      if (!pw) return
      const { error } = await supabase.auth.updateUser({ password: pw })
      if (error) {
        alert('Could not update password: ' + (error.message || 'Unknown error'))
      } else {
        alert('Password updated. You can now log in with your new password.')
        // Optional: refresh or navigate to your normal login flow
        window.location.href = window.location.pathname
      }
    }
  })
</script>
  </body>
</html>

